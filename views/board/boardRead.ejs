<%- include("../include/header.ejs") -%> 

<script src="/js/boardRead.js"></script>

<!-- Body -->
<main>

  <!-- Í≤åÏãúÌåê  -->
  <div class="container">
    <h3 class="mb-5">Í≤åÏãúÌåêÍ∏ÄÎ≥¥Í∏∞</h3>

    <div class="container">
      <div class="d-flex justify-content-md-between mb-3">
        <p>ÏûëÏÑ±Ïùº : <%= new Date(new Date(result.created_at).getTime() + 9*60*60*1000).toISOString().slice(0,19).replace('T',' ') %></p>
        <p>Í≤åÏãúÍ∏Ä Î≤àÌò∏ : <%= result.id %></p>
      </div>

      <div class="mb-3 row">
        <label class="col-sm-2 col-form-label">Í∏ÄÏì¥Ïù¥ : </label>
        <div class="col-sm-10 pt-2">
          <p style="margin-top: 9px;"><%= result.userID %></p>
        </div>
      </div>

      <div class="mb-3 row">
        <label class="col-sm-2 col-form-label">Ï†úÎ™© : </label>
        <div class="col-sm-10 pt-2">
          <p style="margin-top: 9px;"><%= result.title %></p>
        </div>
      </div>

      <div class="mb-3 row">
        <label class="col-sm-2 col-form-label">ÎÇ¥Ïö© : </label>
        <div class="col-sm-10 pt-2">
          <pre style="white-space: pre-wrap; font-family: inherit; font-size: 1rem; margin: 0; margin-top: 9px;">
<%= result.description %>
          </pre>
        </div>
      </div>

      <div class="d-grid gap-2 d-md-flex justify-content-md-end">
        <a href="/board" class="btn btn-primary">ÎèåÏïÑÍ∞ÄÍ∏∞</a>
      </div>
    </div>


    <br>
    <hr>
    <h3>ÎåìÍ∏Ä <%= totalUpmentCount %>Í∞ú</h3>
    
    <!-- ÎåìÍ∏Ä ÏûÖÎ†• ÏÑπÏÖò -->
    <form action="/board/<%= result.id %>/comment/upment" method="POST" class="comment-form">
      <div class="comment-input-section">
        <div class="avatar">ÎÇò</div>
        <div class="input-area">
          <input type="text" name="description" placeholder="ÎåìÍ∏ÄÏùÑ ÏûÖÎ†•ÌïòÏÑ∏Ïöî..." required />
          <button type="submit">ÏûëÏÑ±</button>
        </div>
      </div>
    </form>

    <!-- ÎåìÍ∏Ä Î™©Î°ù ÏÑπÏÖò -->
    <div class="comment-section">
      <% for (var i = 0; i < totalUpmentCount; i++) { %>
        <% result2 = results2[i]; %>
        <div class="comment">
          <div class="avatar">:D</div>
          <div class="content">
            <div class="author-date">
              <span class="author"><%= result2.userID %></span>
              <span class="date"><%= new Date(new Date(result2.created_at).getTime() + 9 * 60 * 60 * 1000).toISOString().slice(0, 19).replace('T', ' ') %></span>
              
              <!-- ÏàòÏ†ï/ÏÇ≠Ï†ú Î≤ÑÌäº -->
              <span class="comment-actions">
                <a href="/board/<%= result2.postID %>/comment/upment/<%= result2.id %>/update" class="upment-update">ÏàòÏ†ï</a>
                <form action="/board/<%= result2.postID %>/comment/upment/<%= result2.id %>?_method=DELETE" method="POST" onsubmit="return confirm(`Ï†ïÎßê ÏÇ≠Ï†úÌïòÏãúÍ≤†ÏäµÎãàÍπå?`);">
                  <button type="submit">ÏÇ≠Ï†ú</button>
                </form>
              </span>
            </div>
            <div class="comment-text"><%= result2.description %></div>
            <div class="actions">
              <button class="like-btn">Ï¢ãÏïÑÏöî</button>
              <span class="like-count"><%= result2.like_count %></span>
              <button class="reply-btn">ÎãµÍ∏Ä ÏûëÏÑ±</button>
            </div>
            <div class="replies">

              <!-- ÎåÄÎåìÍ∏ÄÏù¥ Îì§Ïñ¥Í∞ÄÎäî Í≥µÍ∞Ñ -->
              <div class="reply-input" style="display: none;">
                <form action="/board/<%= result2.postID %>/comment/upment/<%= result2.id %>/downment" method="POST" class="downment-form">
                  <input type="text" name="description" placeholder="ÎãµÍ∏ÄÏùÑ ÏûÖÎ†•ÌïòÏÑ∏Ïöî..." />
                  <button class="submit-reply">ÏûëÏÑ±</button>
                </form>
                <!-- ÎåÄÎåìÍ∏Ä Î™©Î°ù -->
                <div class="reply-section">
                  
                  <% results3.forEach(function(down) { %>
                    <% if (down.parentID === result2.id) { %>
                      <div class="comment reply">
                        <div class="avatar">üòÉ</div>
                        <div class="content">
                          <div class="author-date">
                            <span class="author"><%= down.userID %></span>
                            <span class="date">
                              <%= new Date(new Date(down.created_at).getTime() + 9 * 60 * 60 * 1000)
                                    .toISOString().slice(0, 19).replace('T', ' ') %>
                            </span>
                            <span class="comment-actions">
                              <a href="/board/<%= down.postID %>/comment/upment/<%= down.parentID %>/downment/<%= down.id %>/update" class="downment-update">ÏàòÏ†ï</a>
                              <form action="/board/<%= down.postID %>/comment/upment/<%= down.parentID %>/downment/<%= down.id %>?_method=DELETE" method="POST" onsubmit="return confirm('Ï†ïÎßê ÏÇ≠Ï†úÌïòÏãúÍ≤†ÏäµÎãàÍπå?');">
                                <button type="submit">ÏÇ≠Ï†ú</button>
                              </form>
                            </span>
                          </div>
                          <div class="text"><%= down.description %></div>
                          <div class="actions">
                            <button class="like-btn">Ï¢ãÏïÑÏöî</button>
                            <span class="like-count"><%= down.like_count %></span>
                          </div>
                        </div>
                      </div>
                    <% } %>
                  <% }); %>
                  
                </div>
              </div>
            </div>
          </div>
        </div>

      <% } %>
    </div>

  </div>
</main>

<%- include("../include/footer.ejs") -%>
